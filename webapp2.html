<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ò–≥—Ä–∞ Crypto Drop</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ/–º—É–ª—å—Ç—è—à–Ω–æ–≥–æ –≤–∏–¥–∞ -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Chau+Philomene+One&display=swap" rel="stylesheet">
    <style>
        /* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ç–µ–º */
        :root {
            /* –¶–≤–µ—Ç–∞ —Ç–µ–º—ã Solana (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
            --solana-primary: #9945FF; /* –ù–∞—Å—ã—â–µ–Ω–Ω—ã–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
            --solana-secondary: #14F195; /* –Ø—Ä–∫–æ-–∑–µ–ª–µ–Ω—ã–π */
            --solana-text-color: #ffffff;
            --solana-button-bg: #8040d0;
            --solana-button-hover: #6a34ad;
            --solana-pill-bg: rgba(142, 68, 173, 0.7); /* –ü—Ä–∏–≥–ª—É—à–µ–Ω–Ω—ã–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */

            /* –¶–≤–µ—Ç–∞ —Ç–µ–º—ã TON */
            --ton-primary: #0098EA; /* –°–∏–Ω–∏–π TON */
            --ton-secondary: #ffffff; /* –ë–µ–ª—ã–π */
            --ton-text-color: #ffffff;
            --ton-button-bg: #007bb6;
            --ton-button-hover: #006399;
            --ton-pill-bg: rgba(0, 152, 234, 0.7); /* –ü—Ä–∏–≥–ª—É—à–µ–Ω–Ω—ã–π —Å–∏–Ω–∏–π */

            /* –ó–Ω–∞—á–µ–Ω–∏—è HSL —Ç–µ–º—ã Solana –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã, –±–æ–ª–µ–µ —è—Ä–∫–∏–µ) */
            --solana-bg-h1: 260; --solana-bg-s1: 60; --solana-bg-l1: 30; 
            --solana-bg-h2: 280; --solana-bg-s2: 70; --solana-bg-l2: 50; 

            /* –ó–Ω–∞—á–µ–Ω–∏—è HSL —Ç–µ–º—ã TON –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã, –±–æ–ª–µ–µ —è—Ä–∫–∏–µ) */
            --ton-bg-h1: 205; --ton-bg-s1: 100; --ton-bg-l1: 35; 
            --ton-bg-h2: 190; --ton-bg-s2: 90; --ton-bg-l2: 55; 

            /* –û–±—â–∏–µ/—Ç–µ–∫—É—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - Solana) */
            --current-primary: var(--solana-primary);
            --current-secondary: var(--solana-secondary);
            --current-text-color: var(--solana-text-color);
            --current-button-bg: var(--solana-button-bg);
            --current-button-hover: var(--solana-button-hover);
            --current-pill-bg: var(--solana-pill-bg);

            /* –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è HSL —Ñ–æ–Ω–∞, –æ–Ω–∏ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è */
            --current-bg-h1: var(--solana-bg-h1);
            --current-bg-s1: var(--solana-bg-s1);
            --current-bg-l1: var(--solana-bg-l1);
            --current-bg-h2: var(--solana-bg-h2);
            --current-bg-s2: var(--solana-bg-s2);
            --current-bg-l2: var(--solana-bg-l2);
        }

        body {
            font-family: 'Chau Philomene One', sans-serif; /* –ë–æ–ª–µ–µ –∏–≥—Ä–∏–≤—ã–π —à—Ä–∏—Ñ—Ç */
            background-color: #000; /* –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ü–≤–µ—Ç */
            margin: 0;
            overflow: hidden; /* –°–∫—Ä—ã—Ç—å –ø–æ–ª–æ—Å—ã –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∏–∑-–∑–∞ —Ö–æ–ª—Å—Ç–∞ */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--current-text-color);
        }

        /* –•–æ–ª—Å—Ç –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ */
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            /* –ò—Å–ø–æ–ª—å–∑—É–µ–º HSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –æ–Ω–∏ –±—É–¥—É—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω—ã */
            background-image: linear-gradient(135deg, 
                hsl(var(--current-bg-h1), var(--current-bg-s1)%, var(--current-bg-l1)%) 0%, 
                hsl(var(--current-bg-h2), var(--current-bg-s2)%, var(--current-bg-l2)%) 100%
            );
            /* –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤ HSL */
            transition: 
                --current-bg-h1 1s ease-in-out, 
                --current-bg-s1 1s ease-in-out, 
                --current-bg-l1 1s ease-in-out,
                --current-bg-h2 1s ease-in-out,
                --current-bg-s2 1s ease-in-out,
                --current-bg-l2 1s ease-in-out;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã */
        #gameContainer {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 500px; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã –¥–ª—è –ª—É—á—à–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
            height: 90vh; /* –ó–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—ã—Å–æ—Ç—ã –≤–∏–¥–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ */
            padding: 1rem;
            box-sizing: border-box;
            text-align: center;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–≥—Ä—ã */
        .game-title {
            font-family: 'Press Start 2P', cursive; /* –ü–∏–∫—Å–µ–ª—å–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —à—Ä–∏—Ñ—Ç */
            font-size: 2.5rem; /* –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä */
            color: var(--current-secondary); /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Ç–æ—Ä–∏—á–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —è—Ä–∫–æ—Å—Ç–∏ */
            text-shadow: 4px 4px 0px var(--current-primary), 
                         6px 6px 0px rgba(0,0,0,0.3); /* –†–µ—Ç—Ä–æ-—Ç–µ–Ω—å —Ç–µ–∫—Å—Ç–∞ */
            margin-top: 2rem;
            transition: color 1s ease-in-out, text-shadow 1s ease-in-out, opacity 0.5s ease-in-out;
        }

        /* –ö–Ω–æ–ø–∫–∞ "–ò–≥—Ä–∞—Ç—å" */
        .play-button {
            /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ */
            color: var(--current-text-color);
            font-family: 'Press Start 2P', cursive;
            padding: 1rem 2.5rem;
            border-radius: 12px; /* –ë–æ–ª–µ–µ –∑–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ */
            border: 4px solid var(--current-secondary); /* –Ø—Ä–∫–∞—è —Ä–∞–º–∫–∞ */
            box-shadow: 0 8px 0px var(--current-primary), /* 3D —ç—Ñ—Ñ–µ–∫—Ç */
                        0 12px 20px rgba(0,0,0,0.5);
            font-size: 1.5rem;
            cursor: pointer;
            position: absolute;
            bottom: 2rem;
            right: 1rem; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –Ω–∏–∂–Ω–µ–º—É –ø—Ä–∞–≤–æ–º—É —É–≥–ª—É */
            letter-spacing: 0.1em;
            text-transform: uppercase;

            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω –∏ –µ–≥–æ –∞–Ω–∏–º–∞—Ü–∏—è */
            background: linear-gradient(135deg, var(--current-button-bg) 0%, var(--current-primary) 100%);
            background-size: 200% 200%; /* –î–µ–ª–∞–µ–º —Ñ–æ–Ω –±–æ–ª—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–∞ */
            background-position: 0% 0%; /* –ù–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
            transition: background-position 1.5s ease-out, /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
                        box-shadow 1.5s ease, 
                        transform 0.1s ease, 
                        border-color 0.3s ease, 
                        opacity 0.5s ease-in-out, 
                        visibility 0.5s;
        }
        .play-button:hover {
            background-position: 100% 100%; /* –°–º–µ—â–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
            transform: translateY(-2px);
            box-shadow: 0 10px 0px var(--current-primary), 
                        0 14px 22px rgba(0,0,0,0.6);
        }
        .play-button:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0px var(--current-primary), 
                        0 8px 15px rgba(0,0,0,0.4);
        }
        .play-button.hidden-fade { /* –ö–ª–∞—Å—Å –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º */
            opacity: 0;
            visibility: hidden;
        }

        /* –¢–∞–±–ª–µ—Ç–∫–∞ —Å —à–∏—Ñ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è */
        .cipher-container {
            display: flex;
            align-items: center;
            background-color: var(--current-pill-bg);
            border-radius: 50px; /* –§–æ—Ä–º–∞ —Ç–∞–±–ª–µ—Ç–∫–∏ */
            padding: 0.5rem 1.5rem;
            margin-top: 1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            position: absolute;
            bottom: 2rem;
            left: 1rem; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –Ω–∏–∂–Ω–µ–º—É –ª–µ–≤–æ–º—É —É–≥–ª—É */
            transition: background-color 0.3s ease, opacity 0.5s ease-in-out, visibility 0.5s; /* –î–æ–±–∞–≤–ª–µ–Ω–æ opacity –∏ visibility */
        }
        .cipher-container.hidden-fade { /* –ö–ª–∞—Å—Å –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º */
            opacity: 0;
            visibility: hidden;
        }
        .cipher-text {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            color: var(--current-text-color);
            margin-right: 1rem;
            white-space: nowrap; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
            text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
            transition: color 1s ease-in-out;
        }
        .copy-button {
            /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ */
            color: var(--current-text-color);
            border: none;
            border-radius: 50%; /* –ö—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ */
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1.5rem;
            
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω –∏ –µ–≥–æ –∞–Ω–∏–º–∞—Ü–∏—è */
            background: linear-gradient(135deg, var(--current-secondary) 0%, var(--current-primary) 100%);
            background-size: 200% 200%; /* –î–µ–ª–∞–µ–º —Ñ–æ–Ω –±–æ–ª—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–∞ */
            background-position: 0% 0%; /* –ù–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
            transition: background-position 1.5s ease-out, /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
                        box-shadow 1.5s ease, 
                        transform 0.1s ease;
            box-shadow: 0 4px 0px var(--current-primary); /* –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–µ–Ω—å */
        }
        .copy-button:hover {
            background-position: 100% 100%; /* –°–º–µ—â–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
            filter: brightness(1.1); /* –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —è—Ä–∫–æ—Å—Ç–∏ */
            transform: translateY(-1px);
            box-shadow: 0 5px 0px var(--current-primary);
        }
        .copy-button:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0px var(--current-primary);
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
        .theme-toggle {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.2); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–µ–ª—ã–π */
            border-radius: 50px;
            padding: 0.2rem; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: absolute;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            transition: background-color 0.3s ease;
        }
        .toggle-option {
            padding: 0.3rem 0.8rem; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 60px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
            transition: background-color 0.3s ease, color 0.3s ease, min-width 0.3s ease;
        }
        .toggle-option.active {
            background-color: var(--current-secondary); /* –ê–∫—Ç–∏–≤–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ç–æ—Ä–∏—á–Ω—ã–π —Ü–≤–µ—Ç */
            color: var(--current-text-color);
        }
        .toggle-option img {
            width: 20px; /* –ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏ */
            height: 20px;
            margin: 0 auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –æ–ø—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è */
        }
        /* –°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø–ª–∞–≤–Ω—ã–º, —Ä–µ–≥—É–ª–∏—Ä—É—è —à–∏—Ä–∏–Ω—É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–ø—Ü–∏–∏ */
        .theme-toggle #solana-option.active,
        .theme-toggle #ton-option.active {
            min-width: 80px; /* –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
        }


        /* –ü–∞–¥–∞—é—â–∏–µ –º–æ–Ω–µ—Ç—ã */
        .coin-fall {
            position: absolute;
            width: 50px; /* –†–∞–∑–º–µ—Ä –ø–∞–¥–∞—é—â–∏—Ö –º–æ–Ω–µ—Ç */
            height: 50px;
            opacity: 0;
            animation: fall linear forwards;
            pointer-events: none; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫–∏ */
            cursor: pointer; /* –ö—É—Ä—Å–æ—Ä —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å */
        }
        /* –î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–Ω–µ—Ç, —á—Ç–æ–±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å—é –≤—Å–µ—Ö –º–æ–Ω–µ—Ç */
        #coinFallContainer.game-active .coin-fall {
            pointer-events: auto; /* –í–∫–ª—é—á–∏—Ç—å –∫–ª–∏–∫–∏, –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è */
        }

        @keyframes fall {
            0% {
                transform: translateY(-30vh) rotate(0deg); /* –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã—à–µ —ç–∫—Ä–∞–Ω–∞ (—Å–ª–µ–ø–∞—è –∑–æ–Ω–∞) */
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(110vh) rotate(720deg); /* –£—Ö–æ–¥–∏—Ç –∑–∞ –Ω–∏–∂–Ω–∏–π –∫—Ä–∞–π —ç–∫—Ä–∞–Ω–∞ */
                opacity: 0;
            }
        }

        /* –°—á–µ—Ç—á–∏–∫ –º–æ–Ω–µ—Ç */
        #coinCounter {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
            z-index: 100;
        }
        #coinCounter.show {
            opacity: 1;
            visibility: visible;
        }

        /* –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã */
        #gameTimerDisplay {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
            z-index: 100;
        }
        #gameTimerDisplay.show {
            opacity: 1;
            visibility: visible;
        }


        /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è */
        .status-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 15px 30px;
            border-radius: 10px;
            font-family: sans-serif;
            font-size: 1rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        .status-message.show {
            opacity: 1;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º */
        .promo-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* –¢–µ–º–Ω—ã–π –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s;
        }
        .promo-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .promo-modal-content {
            background-color: #333; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 90%;
            animation: modalPopIn 0.3s ease-out forwards;
            position: relative;
        }

        @keyframes modalPopIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .promo-modal-content h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.8rem;
            color: var(--current-secondary);
            margin-bottom: 15px;
            text-shadow: 2px 2px 0px var(--current-primary);
        }

        .promo-modal-content p {
            font-family: 'Chau Philomene One', sans-serif;
            font-size: 1.1rem;
            color: #ccc;
            margin-bottom: 20px;
        }

        .promo-code-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--current-text-color);
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border: 2px dashed var(--current-secondary);
            display: inline-block;
            letter-spacing: 0.1em;
            cursor: copy; /* Indicate it's copyable */
        }
        .promo-code-display:active {
            transform: scale(0.98);
        }

        .promo-modal-close-button {
            background-color: var(--current-button-bg);
            color: var(--current-text-color);
            font-family: 'Press Start 2P', cursive;
            padding: 0.8rem 2rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            box-shadow: 0 5px 0px var(--current-primary);
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
        }
        .promo-modal-close-button:hover {
            filter: brightness(1.1);
            transform: translateY(-1px);
            box-shadow: 0 6px 0px var(--current-primary);
        }
        .promo-modal-close-button:active {
            transform: translateY(2px);
            box-shadow: 0 3px 0px var(--current-primary);
        }

        /* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ */
        .confetti-piece {
            position: absolute;
            border-radius: 2px;
            animation: confetti-fall linear forwards;
            opacity: 0.8;
        }

        @keyframes confetti-fall {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 0.8;
            }
            100% {
                transform: translate(var(--confetti-dx), var(--confetti-dy)) rotate(var(--confetti-rot)) scale(0);
                opacity: 0;
            }
        }


        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ */
        @media (max-width: 600px) {
            .game-title {
                font-size: 2rem;
            }
            .play-button {
                font-size: 1.2rem;
                padding: 0.8rem 2rem;
                bottom: 1.5rem;
                right: 0.5rem;
            }
            .cipher-container {
                padding: 0.4rem 1rem;
                bottom: 1.5rem;
                left: 0.5rem;
            }
            .cipher-text {
                font-size: 1rem;
                margin-right: 0.5rem;
            }
            .copy-button {
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
            }
            .theme-toggle {
                padding: 0.2rem;
            }
            .toggle-option {
                padding: 0.4rem 0.8rem;
                min-width: 70px;
            }
            .toggle-option img {
                width: 20px;
                height: 20px;
            }
            .coin-fall {
                width: 40px;
                height: 40px;
            }
            #coinCounter, #gameTimerDisplay {
                font-size: 1rem;
                padding: 0.4rem 0.8rem;
                top: 0.5rem;
                right: 0.5rem;
                left: 0.5rem; /* –î–ª—è —Ç–∞–π–º–µ—Ä–∞ */
            }
            .promo-modal-content h2 {
                font-size: 1.5rem;
            }
            .promo-modal-content p {
                font-size: 0.9rem;
            }
            .promo-code-display {
                font-size: 1.2rem;
            }
            .promo-modal-close-button {
                font-size: 1rem;
                padding: 0.6rem 1.5rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    
    <div id="gameContainer">
        <div class="theme-toggle" id="themeToggle">
            <div id="solana-option" class="toggle-option active">
                <img src="./solana_icon.png" alt="Solana" onerror="this.onerror=null;this.src='https://placehold.co/24x24/9945FF/FFFFFF?text=SOL!'">
            </div>
            <div id="ton-option" class="toggle-option">
                <img src="./ton_icon.png" alt="TON" onerror="this.onerror=null;this.src='https://placehold.co/24x24/0098EA/FFFFFF?text=TON!'">
            </div>
        </div>

        <h1 id="gameTitle" class="game-title">Solana Drop</h1>

        <div class="cipher-container" id="cipherContainer">
            <span id="cipherText" class="cipher-text">üåüüåüüåüüåüüåü</span>
            <button id="copyButton" class="copy-button">
                <!-- SVG –ò–∫–æ–Ω–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 0 0 1 2-2h9a2 0 0 1 2 2v1"></path></svg>
            </button>
        </div>

        <button id="playButton" class="play-button">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–∞–¥–∞—é—â–∏—Ö –º–æ–Ω–µ—Ç -->
    <div id="coinFallContainer" class="absolute inset-0 pointer-events-none overflow-hidden z-0"></div>

    <!-- –°—á–µ—Ç—á–∏–∫ –º–æ–Ω–µ—Ç -->
    <div id="coinCounter">0/50</div>

    <!-- –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã -->
    <div id="gameTimerDisplay">1:00</div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="statusMessage" class="status-message"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º -->
    <div id="promoModalOverlay" class="promo-modal-overlay">
        <div class="promo-modal-content">
            <h2 id="promoModalTitle">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
            <p>–í—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥:</p>
            <span id="promoCodeDisplay" class="promo-code-display"></span>
            <p class="mt-4">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–æ–º–æ–∫–æ–¥, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ.</p>
            <button id="closePromoModal" class="promo-modal-close-button">–û—Ç–ª–∏—á–Ω–æ!</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameContainer');
        const gameTitle = document.getElementById('gameTitle');
        const playButton = document.getElementById('playButton');
        const cipherText = document.getElementById('cipherText');
        const cipherContainer = document.getElementById('cipherContainer'); // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        const copyButton = document.getElementById('copyButton');
        const themeToggle = document.getElementById('themeToggle');
        const solanaOption = document.getElementById('solana-option');
        const tonOption = document.getElementById('ton-option');
        const coinFallContainer = document.getElementById('coinFallContainer');
        const statusMessage = document.getElementById('statusMessage');
        const coinCounter = document.getElementById('coinCounter');
        const gameTimerDisplay = document.getElementById('gameTimerDisplay');
        const promoModalOverlay = document.getElementById('promoModalOverlay');
        const promoModalTitle = document.getElementById('promoModalTitle');
        const promoCodeDisplay = document.getElementById('promoCodeDisplay');
        const closePromoModalButton = document.getElementById('closePromoModal');

        let currentTheme = 'solana'; // 'solana' –∏–ª–∏ 'ton'
        let stars = [];
        let numStars = 500;
        let starSpeedMultiplier = 1; // –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        let coinFallInterval = null;
        let gameTimer = null;
        let countdownInterval = null; // –ò–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
        let isGamePlaying = false;
        let isTransitioning = false; // –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞
        let collectedCoins = 0;
        const targetCoins = 50;
        const gameDuration = 60; // 1 –º–∏–Ω—É—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞
        let timeLeft = gameDuration;

        // –ü—Ä–æ–º–æ–∫–æ–¥—ã
        const promoCodes = {
            solana: "FR56G",
            ton: "GT74K"
        };

        // –ü—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –º–æ–Ω–µ—Ç (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
        const solanaCoinImg = new Image();
        solanaCoinImg.src = './solana_coin.png'; 
        solanaCoinImg.onerror = () => {
            console.error("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–Ω–µ—Ç—ã Solana –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞.");
            solanaCoinImg.src = 'https://placehold.co/50x50/9945FF/FFFFFF?text=SOL!';
        };

        const tonCoinImg = new Image();
        tonCoinImg.src = './ton_coin.png';
        tonCoinImg.onerror = () => {
            console.error("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–Ω–µ—Ç—ã TON –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞.");
            tonCoinImg.src = 'https://placehold.co/50x50/0098EA/FFFFFF?text=TON!';
        };

        // --- –ê–Ω–∏–º–∞—Ü–∏—è –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞ –Ω–∞ —Ö–æ–ª—Å—Ç–µ ---
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initStars(); // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–≤–µ–∑–¥—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
        }

        function initStars() {
            stars = [];
            for (let i = 0; i < numStars; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    radius: Math.random() * 1.5 + 0.5,
                    vx: 0, // –ù–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
                    vy: Math.random() * 0.5 + 0.1 // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
                });
            }
        }

        function drawStars() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'white';
            for (let i = 0; i < numStars; i++) {
                const star = stars[i];
                star.y += star.vy * starSpeedMultiplier;
                if (star.y > canvas.height) {
                    star.y = 0;
                    star.x = Math.random() * canvas.width;
                    star.vy = Math.random() * 0.5 + 0.1;
                }
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fill();
            }
            requestAnimationFrame(drawStars);
        }

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π ---
        function applyTheme(theme) {
            const root = document.documentElement;
            if (theme === 'solana') {
                root.style.setProperty('--current-primary', 'var(--solana-primary)');
                root.style.setProperty('--current-secondary', 'var(--solana-secondary)');
                root.style.setProperty('--current-text-color', 'var(--solana-text-color)');
                root.style.setProperty('--current-button-bg', 'var(--solana-button-bg)');
                root.style.setProperty('--current-button-hover', 'var(--solana-button-hover)');
                root.style.setProperty('--current-pill-bg', 'var(--solana-pill-bg)');
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ HSL –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
                root.style.setProperty('--current-bg-h1', 'var(--solana-bg-h1)');
                root.style.setProperty('--current-bg-s1', 'var(--solana-bg-s1)');
                root.style.setProperty('--current-bg-l1', 'var(--solana-bg-l1)');
                root.style.setProperty('--current-bg-h2', 'var(--solana-bg-h2)');
                root.style.setProperty('--current-bg-s2', 'var(--solana-bg-s2)');
                root.style.setProperty('--current-bg-l2', 'var(--solana-bg-l2)');

                gameTitle.textContent = "Solana Drop";
                solanaOption.classList.add('active');
                tonOption.classList.remove('active');
            } else if (theme === 'ton') {
                root.style.setProperty('--current-primary', 'var(--ton-primary)');
                root.style.setProperty('--current-secondary', 'var(--ton-secondary)');
                root.style.setProperty('--current-text-color', 'var(--ton-text-color)');
                root.style.setProperty('--current-button-bg', 'var(--ton-button-bg)');
                root.style.setProperty('--current-button-hover', 'var(--ton-button-hover)');
                root.style.setProperty('--current-pill-bg', 'var(--ton-pill-bg)');

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ HSL –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
                root.style.setProperty('--current-bg-h1', 'var(--ton-bg-h1)');
                root.style.setProperty('--current-bg-s1', 'var(--ton-bg-s1)');
                root.style.setProperty('--current-bg-l1', 'var(--ton-bg-l1)');
                root.style.setProperty('--current-bg-h2', 'var(--ton-bg-h2)');
                root.style.setProperty('--current-bg-s2', 'var(--ton-bg-s2)');
                root.style.setProperty('--current-bg-l2', 'var(--ton-bg-l2)');

                gameTitle.textContent = "TON Drop";
                solanaOption.classList.remove('active');
                tonOption.classList.add('active');
            }
            currentTheme = theme;
            // –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å canvas.style.backgroundImage –Ω–∞–ø—Ä—è–º—É—é, CSS –ø–µ—Ä–µ—Ö–æ–¥ —ç—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.
        }

        // --- –õ–æ–≥–∏–∫–∞ –ø–∞–¥–µ–Ω–∏—è –º–æ–Ω–µ—Ç ---
        function createFallingCoin() {
            // –°–æ–∑–¥–∞–≤–∞—Ç—å –º–æ–Ω–µ—Ç—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞
            if (!isGamePlaying) return;

            const coin = document.createElement('img');
            coin.className = 'coin-fall';
            coin.src = currentTheme === 'solana' ? solanaCoinImg.src : tonCoinImg.src;
            
            // –ù–µ–º–Ω–æ–≥–æ —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –º–æ–Ω–µ—Ç—ã
            const size = Math.random() * (60 - 40) + 40; // –†–∞–∑–º–µ—Ä –æ—Ç 40px –¥–æ 60px
            coin.style.width = `${size}px`;
            coin.style.height = `${size}px`;

            // –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≤—Å–µ–π —à–∏—Ä–∏–Ω–µ —ç–∫—Ä–∞–Ω–∞
            coin.style.left = `${Math.random() * (window.innerWidth - size)}px`;
            // –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
            coin.style.animationDuration = `${Math.random() * 3 + 2}s`; // –û—Ç 2 –¥–æ 5 —Å–µ–∫—É–Ω–¥
            // –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –∞–Ω–∏–º–∞—Ü–∏–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–ª—è–ª–∏—Å—å –º–µ–Ω–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
            coin.style.animationDelay = `-${Math.random() * 2}s`; 

            // –°–¥–µ–ª–∞—Ç—å –º–æ–Ω–µ—Ç—É –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–π
            // pointer-events: auto; —Ç–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–ª–∞—Å—Å–æ–º game-active –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
            coin.addEventListener('click', (event) => {
                if (isGamePlaying) { // –°—á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–≥—Ä–∞ –∞–∫—Ç–∏–≤–Ω–∞
                    collectedCoins++;
                    updateCounterDisplay();
                    
                    // –í–∏–±—Ä–æ–æ—Ç–¥–∞—á–∞
                    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.HapticFeedback) {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
                    }

                    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
                    createConfetti(event.clientX, event.clientY, currentTheme);

                    coin.remove(); // –£–¥–∞–ª–∏—Ç—å –º–æ–Ω–µ—Ç—É –ø—Ä–∏ –∫–ª–∏–∫–µ
                    event.stopPropagation(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è, —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                }
            });

            coinFallContainer.appendChild(coin);

            // –£–¥–∞–ª–∏—Ç—å –º–æ–Ω–µ—Ç—É –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–∞–∑–¥—É–≤–∞–Ω–∏–µ DOM
            coin.addEventListener('animationend', () => {
                coin.remove();
            });
        }

        // --- –õ–æ–≥–∏–∫–∞ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ ---
        function createConfetti(x, y, theme) {
            const confettiContainer = document.createElement('div');
            confettiContainer.style.position = 'fixed';
            confettiContainer.style.left = `${x}px`;
            confettiContainer.style.top = `${y}px`;
            confettiContainer.style.pointerEvents = 'none'; // –ù–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∫–ª–∏–∫–∏
            confettiContainer.style.zIndex = '9999'; // –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ —Å–≤–µ—Ä—Ö—É

            const colors = theme === 'solana' 
                ? ['var(--solana-secondary)', 'var(--solana-primary)', '#ffffff', '#000000'] // –¶–≤–µ—Ç–∞ Solana –∏ –±–µ–ª—ã–π/—á–µ—Ä–Ω—ã–π –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
                : ['var(--ton-secondary)', 'var(--ton-primary)', '#000000', '#cccccc']; // –¶–≤–µ—Ç–∞ TON –∏ —á–µ—Ä–Ω—ã–π/—Å–µ—Ä—ã–π

            const numPieces = 15; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É—Å–æ—á–∫–æ–≤ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            for (let i = 0; i < numPieces; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece'; // –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–±—â–∏–π –∫–ª–∞—Å—Å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                piece.style.width = `${Math.random() * 8 + 4}px`; // –†–∞–∑–º–µ—Ä –æ—Ç 4 –¥–æ 12px
                piece.style.height = piece.style.width;
                piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                // –†–∞–Ω–¥–æ–º–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –∏ –≤—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                const finalX = (Math.random() - 0.5) * 100; // –†–∞—Å—Ö–æ–¥—è—â–µ–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏–µ
                const finalY = (Math.random() - 0.5) * 100;
                const rotation = Math.random() * 720; // –í—Ä–∞—â–µ–Ω–∏–µ –¥–æ 720 –≥—Ä–∞–¥—É—Å–æ–≤
                const duration = Math.random() * 0.7 + 0.5; // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 0.5 –¥–æ 1.2 —Å–µ–∫—É–Ω–¥

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                piece.style.setProperty('--confetti-dx', `${finalX}px`);
                piece.style.setProperty('--confetti-dy', `${finalY}px`);
                piece.style.setProperty('--confetti-rot', `${rotation}deg`);
                piece.style.animationDuration = `${duration}s`;

                confettiContainer.appendChild(piece);
            }

            document.body.appendChild(confettiContainer);

            // –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                confettiContainer.remove();
            }, 1200); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ + –Ω–µ–±–æ–ª—å—à–æ–π –±—É—Ñ–µ—Ä
        }


        function updateCounterDisplay() {
            coinCounter.textContent = `${collectedCoins}/${targetCoins}`;
        }

        function startGame() {
            if (isGamePlaying) return; // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞, –≤—ã–π—Ç–∏
            isGamePlaying = true;
            collectedCoins = 0; // –°–±—Ä–æ—Å —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –º–æ–Ω–µ—Ç
            updateCounterDisplay();
            timeLeft = gameDuration; // –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞
            updateTimerDisplay(); // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞

            // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É "–ò–≥—Ä–∞—Ç—å" –∏ –±–ª–æ–∫ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º
            playButton.classList.add('hidden-fade'); 
            cipherContainer.classList.add('hidden-fade'); 
            
            // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ –º–æ–Ω–µ—Ç –∏ —Ç–∞–π–º–µ—Ä
            coinCounter.classList.add('show'); 
            gameTimerDisplay.classList.add('show');

            playButton.disabled = true; // –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã
            cipherText.style.pointerEvents = 'none'; // –û—Ç–∫–ª—é—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            copyButton.disabled = true; // –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            coinFallContainer.classList.add('game-active'); // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–Ω–µ—Ç

            starSpeedMultiplier = 5; // –£—Å–∫–æ—Ä–∏—Ç—å —Ñ–æ–Ω

            // –ù–∞—á–∞—Ç—å –ø–∞–¥–µ–Ω–∏–µ –º–æ–Ω–µ—Ç (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
            coinFallInterval = setInterval(createFallingCoin, 350); 

            // –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä–æ–≤–æ–π —Ç–∞–π–º–µ—Ä
            countdownInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    stopGame();
                    if (collectedCoins >= targetCoins) {
                        showPromoCodeModal(true); // –ü–æ–±–µ–¥–∞ –ø–æ –æ—á–∫–∞–º
                    } else {
                        showStatus(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã —Å–æ–±—Ä–∞–ª–∏ ${collectedCoins} –º–æ–Ω–µ—Ç.`); // –ü–æ—Ä–∞–∂–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
                    }
                }
            }, 1000);

            // –¢–∞–π–º–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–≥—Ä—ã —á–µ—Ä–µ–∑ gameDuration —Å–µ–∫—É–Ω–¥
            gameTimer = setTimeout(() => {
                if (isGamePlaying) { // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–≥—Ä–∞ –Ω–µ –±—ã–ª–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤—Ä—É—á–Ω—É—é
                    stopGame();
                    if (collectedCoins >= targetCoins) {
                        showPromoCodeModal(true); // –ü–æ–±–µ–¥–∞ –ø–æ –æ—á–∫–∞–º
                    } else {
                        showStatus(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã —Å–æ–±—Ä–∞–ª–∏ ${collectedCoins} –º–æ–Ω–µ—Ç.`); // –ü–æ—Ä–∞–∂–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
                    }
                }
            }, gameDuration * 1000); // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–µ–∫—É–Ω–¥—ã –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
        }

        function stopGame() {
            if (!isGamePlaying) return; // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –≤—ã–π—Ç–∏
            isGamePlaying = false;
            
            // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ò–≥—Ä–∞—Ç—å" –∏ –±–ª–æ–∫ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º
            playButton.classList.remove('hidden-fade'); 
            cipherContainer.classList.remove('hidden-fade'); 
            
            // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã—Ç—å —Å—á–µ—Ç—á–∏–∫ –º–æ–Ω–µ—Ç –∏ —Ç–∞–π–º–µ—Ä
            coinCounter.classList.remove('show'); 
            gameTimerDisplay.classList.remove('show');

            playButton.disabled = false;
            cipherText.style.pointerEvents = 'auto'; // –í–∫–ª—é—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            copyButton.disabled = false;
            coinFallContainer.classList.remove('game-active'); // –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–Ω–µ—Ç

            starSpeedMultiplier = 1; // –°–±—Ä–æ—Å–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ñ–æ–Ω–∞
            clearInterval(coinFallInterval);
            coinFallInterval = null;
            clearInterval(countdownInterval); // –û—á–∏—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
            clearTimeout(gameTimer); // –û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä –∏–≥—Ä—ã
            gameTimer = null;

            // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞–¥–∞—é—â–∏–µ –º–æ–Ω–µ—Ç—ã
            coinFallContainer.innerHTML = '';
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            gameTimerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        // --- –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ —Å—Ç–∞—Ç—É—Å–µ ---
        function showStatus(message, duration = 2000) {
            statusMessage.textContent = message;
            statusMessage.classList.add('show');
            setTimeout(() => {
                statusMessage.classList.remove('show');
            }, duration);
        }

        // --- –õ–æ–≥–∏–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞ ---
        function showPromoCodeModal(isWin = false) {
            let promoCode = promoCodes[currentTheme];
            if (isWin) {
                promoModalTitle.textContent = "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!";
                promoCodeDisplay.textContent = promoCode;
            } else {
                promoModalTitle.textContent = "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!";
                promoCodeDisplay.textContent = "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!"; // –ò–ª–∏ –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–∏–≥—Ä—ã—à–∞
            }
            promoModalOverlay.classList.add('show');
        }

        function hidePromoCodeModal() {
            promoModalOverlay.classList.remove('show');
        }

        // --- –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π ---
        playButton.addEventListener('click', startGame); // –í—ã–∑—ã–≤–∞–µ–º startGame –Ω–∞–ø—Ä—è–º—É—é

        copyButton.addEventListener('click', () => {
            const textToCopy = cipherText.textContent;
            try {
                // –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç textarea
                const textarea = document.createElement('textarea');
                textarea.value = textToCopy;
                textarea.style.position = 'fixed'; // –ò–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –¥–æ –Ω–∏–∑–∞
                textarea.style.opacity = '0'; // –°–∫—Ä—ã—Ç—å –µ–≥–æ
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy'); // –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
                document.body.removeChild(textarea); // –û—á–∏—Å—Ç–∏—Ç—å
                showStatus('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
            } catch (err) {
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç: ', err);
                showStatus('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.');
            }
        });

        promoCodeDisplay.addEventListener('click', () => {
            const textToCopy = promoCodeDisplay.textContent;
            try {
                const textarea = document.createElement('textarea');
                textarea.value = textToCopy;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showStatus('–ü—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            } catch (err) {
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥: ', err);
                showStatus('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞.');
            }
        });


        closePromoModalButton.addEventListener('click', hidePromoCodeModal);

        themeToggle.addEventListener('click', async () => {
            if (isTransitioning) return; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–∫–æ–≤ –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞
            isTransitioning = true;
            
            stopGame(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –∏–≥—Ä—É –∏ –æ—á–∏—Å—Ç–∏—Ç—å –º–æ–Ω–µ—Ç—ã

            gameTitle.style.opacity = 0; // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
            gameContainer.style.pointerEvents = 'none'; // –û—Ç–∫–ª—é—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞ (–≤–∞–∂–Ω–æ)
            themeToggle.style.pointerEvents = 'none'; // –û—Ç–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞

            // –ü–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏—Å—á–µ–∑–Ω–µ—Ç
            await new Promise(resolve => setTimeout(resolve, 500)); 

            const newTheme = currentTheme === 'solana' ? 'ton' : 'solana';
            applyTheme(newTheme);

            // –ü–æ–¥–æ–∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ —Ñ–æ–Ω–∞ (1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å–≤–æ–π—Å—Ç–≤–∞ HSL)
            await new Promise(resolve => setTimeout(resolve, 1000)); 
            
            gameTitle.style.opacity = 1; // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
            gameContainer.style.pointerEvents = 'auto'; // –ü–æ–≤—Ç–æ—Ä–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
            themeToggle.style.pointerEvents = 'auto'; // –ü–æ–≤—Ç–æ—Ä–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã
            isTransitioning = false;
        });

        // –ù–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas(); // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ö–æ–ª—Å—Ç–∞ –∏ –∑–≤–µ–∑–¥—ã
        drawStars(); // –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ü–∏–∫–ª –∞–Ω–∏–º–∞—Ü–∏–∏ –∑–≤–µ–∑–¥
        applyTheme('solana'); // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–µ–º—É
        updateCounterDisplay(); // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—á–µ—Ç—á–∏–∫–∞
        updateTimerDisplay(); // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Ç–∞–π–º–µ—Ä–∞
    </script>
</body>
</html>
